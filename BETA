
Changelog for the Beta Releases
===============================

Where possible, notes in [brackets] indicate when the error was
introduced. Non-specific version numbers indicate the following:
	- 2.0 (Introduced in TinyMUSH 2.0.10p6 or earlier.)
	- 2.2 (Introduced in TinyMUSH 2.2.5 or earlier.)
	- MUX (Introduced in TinyMUX 1.6 or earlier.)
	- 3.0 (Introduced in TinyMUSH 3.0 at some point in time.)

Names after the bug origin version are the first sources for the bug
reports. Where no name is given, the bug was discovered by the
developers. ("RMG" refers to Robby Griffin, aka Alierak.)

The initial beta release was on 9/27/99.

-----------------------------------------------------------------------------

9/28/99: Beta 2

- Fix: Compilation problem with MEMORY_BASED defined. [3.0; Roloran]

- Fix: XFREE macro missing argument compiler error. [3.0; Roloran]

- Fix: Fatal error in let(). [3.0a8; RMG]

- Fix: Off-by-one, integer overflow, and bounds-checking issues. Verified
  with Purify. [RMG]

- Fix: Cannot set/reset ROBOT flag on players. [MUX]

-----------------------------------------------------------------------------

9/29/99: Beta 3

- Fix: Pueblo support works again. [3.0; GrimJim]

- Fix: Structure names cannot contain periods. [3.0a8; stile]

- Fix: translate() works as documented, and handles backslashes correctly.
  [MUX; RMG]

- Fix: pmatch() correctly handles dbrefs. [3.0a11; RMG]

- Fix: Command switch issues fixed for @mail, @malias, @wipe. [2.0; RMG]

- Fix: Side-effect function permissions are checked more thoroughly. [MUX; RMG]

- Fix: Double-free issue in switchall(). [3.0a8; RMG]

- Change: mix() can take up to twelve arguments (rather than ten).

- Cosmetic: Dealt with a compiler warning in flags.c.

- Docs: Updated mailing list subscription info in help.

-----------------------------------------------------------------------------

9/30/99: Beta 4

- Fix: @clone correctly copies all flags. [3.0; RMG]

- Fix: @open requires the invoker to have contents. [2.0; RMG]

- Fix: Parent recursion issues have been prevented in various places.
  [2.0; RMG]

- Fix: parse() checks function invocations in a manner identical to iter().
  [2.0; Myrrdin]

- Fix: Slaves are reaped with waitpid() so zombies are not created by
  @restart (may be Linux-specific problem). [MUX; Myrddin]

- Fix: Signals are unblocked at startup, allowing SIGUSR1 to be invoked
  for later instances in restarts. [MUX; RMG]

- Misc: The unused parentable_control_lock parameter has been removed.

- Misc: A variety of compiler warnings related to uninitialized variables, 
  unused variables, implicit function declarations, etc. have been taken
  care of.

-----------------------------------------------------------------------------

10/2/99: Beta 5

- Feature: lstructures() and linstances() functions added.

- Fix: @dbclean has been rewritten, and now works (and is more efficient).
  [3.0; Thomas Wouters]

- Fix: Where pow() is used in conjunction with htonl(), it is cast to
  unsigned int. This fixes a compilation issue with Linux and gcc -O.
  [3.0a5; stile]

- Fix: Some structures are no longer allocated as lbufs, but are explicitly
  malloc'd in a type-specific manner. [2.0]

- Fix: Forwardlists are loaded before startups are run. [2.0]

- Fix: @mail/fwd now explicitly checks to see if a mail message is in
  progress. [MUX; Dan Ryan]

- Fix: INFO now works when used by logged-in players. [3.0a2; RMG]

- Fix: trunc() truncates rather than rounds. [MUX; Keran]

- Fix: Dumping and shutdown check to make sure the game is not already
  dumping. [2.0; Geoff Gerrietts]

- Fix: The display of exit destinations for Transparent rooms now handles
  "special" exit destinations. [2.2/MUX; RMG]

- Fix: Some oddities with attribute renaming have been taken care of.
  [2.0; RMG]

- Fix: The static buffers for Name and PureName are of the appropriate type.
  [MUX; RMG]

- Fix: Instance name lengths are restricted to half an sbuf. [3.0a8; RMG]

- Fix: Startmush handles checking if the game is running in a better manner.
  [RMG]

- Misc: The GDBM bucket cache size has been reduced to 1 bucket.

-----------------------------------------------------------------------------

10/4/99: Beta 6

- Fix: Money is no longer deducted twice when creating an object. [3.0]

- Fix: Another pow()/htonl() fix. [3.0a5; Markus Stenberg]

- Fix: Various compile-time option #ifdef's cleaned up. [3.0]

- Fix: Removed spurious spaces in columns() when a string is truncated.
  [3.0b2; Keran]

- Fix: Cosmetic change to @list textfiles. [3.0a5]

- Misc: chown_anything also lets you @chown to anyone.

- Misc: Doubled the size of the function and user function hash tables.

- Misc: Got rid of the SIDE_EFFECT_FUNCTIONS compile-time option, since
  you can simply function_access the side-effect functions to 'disabled'.

-----------------------------------------------------------------------------

10/5/99: Beta 7

- Feature: New conf parameter stripped_flags determines what flags are
  stripped when an object is subject to a @chown, @chownall, or @clone.
  These commands now take a /nostrip switch, which negates stripping.
  For consistency, @clone/inherit no longer preserves IMMORTAL (only
  INHERIT).

- Fix: Side-effect function prototypes exist again. [3.0b6; Tina Verras]

- Fix: You can no longer set the cost of non-things in @clone (consistent
  with other object-creation commands). [MUX]

- Fix: The value of @clone'd objects is now correctly set. (Previously,
  all cloned objects had a value, i.e. Pennies, of zero.) [MUX]

- Misc: All @clone switches except /inventory and /location can be combined.

- Misc: @clone/preserve can be used by anyone, but you must control the
  original object's owner.

- Misc: ansi() compacts the ANSI codes, and makes a better attempt against
  avoiding bleeding.

-----------------------------------------------------------------------------

10/7/99: Beta 8

- Feature: @cron implemented, providing Unix-style cron scheduling.
  @daily has been re-implemented using the @cron facility.

- Feature: Functions that take output delimiters can now take a null
  output delimiter, signified by the token '@@'.

- Feature: The examine command has a new switch, /pairs. This shows
  paren/bracket/braces-matching in ANSI color. (Based on the engine
  from ChaoticMUX's parenmatch() function.)

- Feature: New conf directive raw_helpfile allows the addition of
  non-evaluated helpfiles.

- Feature: Added the MUSH Manual to the distribution in helpfile format.
  (Thanks to Alierak and sTiLe.)

- Feature: delete(), mid(), left() and right() no longer strip ANSI
  characters.

- Fix: SQL queries error out properly when support is not compiled in.
  [3.0a13; Blane Dabney]

- Fix: @clone/nostrip can be combined with all other @clone switches.
  [3.0b7]

- Fix: The 2.2 database conversion converts the Builder flag to the
  Builder power, rather than just discarding the flag. [3.0a4]

- Fix: Comtitles are terminated with ANSI_NORMAL where appropriate.
  [MUX; Brazil]

- Fix: sortby() no longer ignores its output delimiter. [2.2]

- Fix: translate() can handle compacted ANSI strings generated by
  ansi(). [3.0b7]

- Fix: hastype() can be used on an object, even if you can't examine it,
  since you can type() anything. [MUX; stile]

- Misc: Typecast time_t to int when using it in conjunction with printf().

- Did a diff between ChaoticMUX-S3, and TinyMUX 1.6p0. Derived a suite
  of bugfixes and some enhancements, as follows:

  - Feature: @function/noeval defines a user-defined function whose
    arguments are not pre-evaluated.

  - Feature: An ANSI underline code, %xu, has been added.

  - Feature: log() can take an optional second argument, the base.

  - Fix: elock() obeys the pass_locks power. [MUX]

  - Fix: Pool headers are 64-bit aligned. [2.0]

  - Fix: Calls to site_check() check the return value ANDed against the flag.
    [2.0]

  - Fix: The overflow buffer for functions is terminated properly. [MUX]

  - Fix: Missed some places where see_hidden should apply. [3.0a14]

  - Fix: OUTPUTSUFFIX without OUTPUTPREFIX works. [2.0]

  - Misc: All calls to abort() log a message. [2.0]

  - Misc: mail() and mailfrom() check arg ranges in the standard way. [MUX]

  - Misc: ANSI defines are used rather than embedding raw codes. [MUX]

  - Misc: No spurious extra args to raw_broadcast() calls. [MUX]

-----------------------------------------------------------------------------

10/8/99: Beta 9

- Feature: @destroy/instant instantly destroys an object, rather than
  queueing it for recycling. The new conf option instant_recycle
  controls whether or not objects set Destroy_OK (or which have
  Destroy_OK owners) get instantly destroyed; it defaults to 'yes'.

- Feature: @list options now shows just boolean parameters, and the
  display format is now much neater (and in alphabetical order of
  the actual parameter names). A new command, @list params, shows
  a variety of other conf options.

- Fix: left() works properly again. [3.0b8; Jeff Hulsey]

- Fix: format_exits conf parameter is recognized again. [3.0]

- Misc: Unused conf parameters eliminated.

-----------------------------------------------------------------------------

10/8/99: Beta 10

- Feature: edit() can now edit ANSI strings. @edit also handles ANSI
  in a better manner.

- Fix: Conf parameter unowned_safe is back. (Oops.) [3.0b9; utoxin]

- Fix: Failed movement through a global or zone exit results in
  "You can't go that way." rather than no output.
  [2.0/2.2; Markleford Friedman]

- Fix: Fixed an obscure bug where, in the match confidence calculation,
  the "you can pass this lock" check always succeeded. [MUX]

- Fix: A variety of inappropriate malloc()s have been dealt with,
  and XMALLOC/XFREE are now used by the mail code. [2.0/MUX]

- Misc: sql_init()'s shutdown of a SQL socket calls sql_shutdown()
  instead of doing just doing it.

- Misc: A variety of compiler warnings have been dealt with.

- Went through the TinyMUSH 2.2 changes log again, looking for code
  that was not incorporated. Resulted in the following changes:

  - Fix: Never show HTML to non-HTML players. [MUX]

  - Fix: A variety of buffer overflow issues have been dealt with. [2.0]

  - Fix: Null pointer dereference in con/exit formatting. [2.2]

  - Misc: Some minor improvements to the queueing of output.

-----------------------------------------------------------------------------

10/11/99: Beta 11

- Feature: iter(), list(), switch(), and switchall() can now be nested
  (i.e., the special tokens ##, #@, and #$ are substituted in-scope).
  The new token '#!' gives nest level within iter() and list(), and
  switch() and switchall().

  This changes the parsing of these tokens, which are no longer blindly
  substituted for, particularly with regard to escapes (for instance,
  '\##' now results in a literal '##'). For backwards compatibility,
  use parse() instead of iter() -- parse() behaves like it always has --
  and use loop() instead of list(). There is no backwards-compatible
  function for switch(), as it's unlikely there's softcode out there
  that relies on a particular escaping behavior for '#$'.

- Feature: Two new flag_access permission types have been implemented,
  'restrict_player' makes a flag only settable on players by Wizards,
  but on objects of other types by mortals (FIXED, for instance).
  'privileged' makes a flag only settable on players by God, but
  it can be set on objects of other types by non-robot players
  who themselves have the flag.

- Fix: Backspaces and deletes on an empty line should no longer result
  in negative input totals. [2.0; RMG]

- Fix: You can no longer give anything to an exit. [2.0; RMG]

- Fix: Obvious Exits lists are no longer eaten for non-HTML players.
  [3.0b10; Keran]

- Misc: 'th' now aliases to 'think' rather than 'throw', by default.

- Misc: udefault() can take up to 12 arguments.

- Misc: Perl versions of the sed scripts for database conversion
  now exist, and are recommended. (The vast majority of users will
  have perl, and the perl regular expressions are less likely to
  result in "false positive" conversions.)

-----------------------------------------------------------------------------

10/13/99: Beta 12

- Feature: '%r' is now a legal output delimiter. lnum() now treats its
  delimiter like an output delimiter (so '@@' and '%r' are both legal).
  sql() now treats both of its delimiters like output delimiters.

- Fix: dark_sleepers conf option is displayed in reverse. [3.0b9; Tina Verras]

- Fix: Structure-related data is cleared out when an object is
  destroyed. [3.0a8; RMG]

- Fix: Absurd channel charges are no longer allowed. [MUX; RMG]

- Fix: There are no spurious spaces embedded between the psuedo-HTML tags
  and exit names, for Pueblo display of exits. [MUX]

- Fix: @emit/room/html no longer produces double output. [2.2/MUX; GrimJim]

- Misc: You can no longer use addcom to join a channel multiple times.
  (Previously, it was permitted, but you got a warning; there didn't seem
  to be a good reason to ever allow it, though.)

- Misc: Dealt with a few more compiler warnings, and got rid of some
  unnecessarily clumsy constructs.

-----------------------------------------------------------------------------

10/16/99: Beta 13

- Fix: Channel names and aliases are sanity-checked. [MUX; RMG]

- Misc: Use of *VARIABLE* as the object name associated with #-2 is
  now consistent. [3.0a3; Keran]

- Misc: Corrected a typo in @quota. [2.0; RMG]

- Misc: Leaving a channel you are not on generates a notification
  that you're not on the channel. [MUX; stile]
