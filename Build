#!/bin/sh

echo "Building TinyMUSH 3.1..."

echo
echo "***** Configuring GNU DBM..."
echo
cd src/gdbm-1.8.0
./configure --enable-shared=no --enable-static=yes
echo
echo "***** Building GNU DBM..."
echo
make

echo
echo "***** Configuring the server..."
cd ..
./configure
echo
echo "***** Building modules..."
echo
moduledirs1=`find modules -name configure.in -print | sed 's/\/configure.in//g'`
moduledirs=`echo $moduledirs1`
for dir in $moduledirs; do
	cd $dir && make 2>&1 | tee Compile.log
	if [ $? -ne 0 ]; then
		exit
	fi
	cd ../..
done
echo "***** Building server using default config..."
echo
rm -f .depend
touch .depend
make 2>&1 | tee Compile.log
cd ..

echo
echo "Done."
